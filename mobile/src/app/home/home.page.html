<ion-header class="ion-no-border">
  <ion-toolbar class="transparent-toolbar">
    <div class="header-row">
      <h1 class="page-title">Schedule</h1>
      <app-sync-indicator [syncState]="syncState"></app-sync-indicator>
    </div>

    <!-- Inline Date -->
    <p class="header-date">{{ currentDateString }}</p>

    <!-- Minimal Segment -->
    <div class="custom-segment">
      <button [class.active]="viewMode === 'day'" (click)="viewMode = 'day'; loadReservations()">Day</button>
      <button [class.active]="viewMode === 'week'" (click)="viewMode = 'week'; loadReservations()">Week</button>
      <button [class.active]="viewMode === 'month'" (click)="viewMode = 'month'; loadReservations()">Month</button>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="bg-light">
  <ion-refresher slot="fixed" (ionRefresh)="loadReservations()">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <!-- Simplified Event Selector -->
  <!-- We'll keep it but make it minimal in CSS -->

  <!-- Event Selector -->
  <div class="provider-selector">
    <ion-item lines="none">
      <ion-icon name="calendar-number-outline" slot="start" color="primary"></ion-icon>
      <ion-label>Event</ion-label>
      <ion-select [(ngModel)]="selectedEvent" (ionChange)="onEventChange($event)" interface="popover"
        placeholder="Select Event">
        <ion-select-option *ngFor="let event of events" [value]="event.id">
          {{ event.name }}
        </ion-select-option>
      </ion-select>
    </ion-item>
  </div>

  <!-- Grouped Schedule Sections -->
  <div class="schedule-container">
    <app-schedule-group *ngFor="let section of sections" [section]="section" [onCancel]="handleCancel.bind(this)"
      [onReschedule]="handleReschedule.bind(this)" [onCheckIn]="handleCheckIn.bind(this)"
      [onViewConflict]="handleViewConflict.bind(this)" [getEventName]="getEventName.bind(this)">
    </app-schedule-group>

    <!-- Empty State -->
    <div *ngIf="hasNoReservations" class="empty-state">
      <ion-icon name="calendar-outline"></ion-icon>
      <h2>No Reservations</h2>
      <p>You have no scheduled reservations for this period.</p>
      <ion-button (click)="loadReservations()">
        <ion-icon slot="start" name="refresh"></ion-icon>
        Refresh
      </ion-button>
    </div>
  </div>
</ion-content>